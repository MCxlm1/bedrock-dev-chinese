import{_ as t,E as n,j as l,k as r,a5 as e,A as i}from"./chunks/framework.3Z9w-w8R.js";const o="/assets/images/knowledge/shaders/debugShader.gif",b=JSON.parse('{"title":"Shaders","description":"Shaders for MCBE.","frontmatter":{"title":"Shaders","mentions":["SirLich","Dreamedc2015","yanasakana","MedicalJewel105","SIsilicon"],"description":"Shaders for MCBE."},"headers":[{"level":2,"title":"Overview","slug":"overview","link":"#overview","children":[]},{"level":2,"title":"Materials","slug":"materials","link":"#materials","children":[{"level":3,"title":"Common material definition fields","slug":"common-material-definition-fields","link":"#common-material-definition-fields","children":[]}]},{"level":2,"title":"Troubleshooting","slug":"troubleshooting","link":"#troubleshooting","children":[{"level":3,"title":"Shader doesn’t change","slug":"shader-doesn-t-change","link":"#shader-doesn-t-change","children":[]},{"level":3,"title":"Compilation error","slug":"compilation-error","link":"#compilation-error","children":[]},{"level":3,"title":"Couldn’t find constant buffer named: $Globals","slug":"couldn-t-find-constant-buffer-named-globals","link":"#couldn-t-find-constant-buffer-named-globals","children":[]}]},{"level":2,"title":"Tips and tricks","slug":"tips-and-tricks","link":"#tips-and-tricks","children":[{"level":3,"title":"Passing variables to the shader","slug":"passing-variables-to-the-shader","link":"#passing-variables-to-the-shader","children":[]},{"level":3,"title":"Using time in shader","slug":"using-time-in-shader","link":"#using-time-in-shader","children":[]},{"level":3,"title":"Camera direction towards the entity","slug":"camera-direction-towards-the-entity","link":"#camera-direction-towards-the-entity","children":[]},{"level":3,"title":"Debugging values","slug":"debugging-values","link":"#debugging-values","children":[]}]}],"relativePath":"concepts/shaders.md","filePath":"concepts/shaders.md"}'),d={name:"concepts/shaders.md"};function h(p,s,c,u,k,g){const a=n("CodeHeader");return r(),l("div",null,[s[0]||(s[0]=e('<div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>The shaders on this page are incompatible with <a href="https://help.minecraft.net/hc/en-us/articles/360052771272-About-the-1-16-200-Update-for-Windows-10-" target="_blank" rel="noreferrer">Render Dragon</a>. That means that they will not work on Windows and Console devices past 1.16.200, nor other devices past 1.18.30!</p></div><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>Shaders are divided into 2 folders: <code class="shiki"><span>glsl</span></code> and <code class="shiki"><span>hlsl</span></code>. For shaders to work on every device, you need to code shaders in both languages. For testing on Windows, <code class="shiki"><span>hlsl</span></code> is enough. When rewriting shaders from one language to another, there are few things to change, like HLSL <code class="shiki"><span>float3</span></code> is <code class="shiki"><span>vec3</span></code> in GLSL. Mapping between those languages can be found <a href="https://anteru.net/blog/2016/mapping-between-HLSL-and-GLSL/" target="_blank" rel="noreferrer">here</a></p><h2 id="materials" tabindex="-1">Materials <a class="header-anchor" href="#materials" aria-label="Permalink to &quot;Materials&quot;">​</a></h2><p>Vertex, fragments, and sometimes geometry shaders are combined with some options as materials and are required for custom shaders. To create new material, you need to create a file, which matches the name of the .material file in the vanilla resource pack. For example: <code class="shiki"><span>materials/particles.material</span></code>. Materials support inheritance by adding parent material after a colon. For example: <code class="shiki"><span>entity_alpha:entity_base</span></code></p><h3 id="common-material-definition-fields" tabindex="-1">Common material definition fields <a class="header-anchor" href="#common-material-definition-fields" aria-label="Permalink to &quot;Common material definition fields&quot;">​</a></h3><table tabindex="0"><thead><tr><th><strong>Field name</strong></th><th><strong>Description</strong></th><th><strong>Example value</strong></th><th><strong>Notes</strong></th></tr></thead><tbody><tr><td><code class="shiki"><span>vertexShader</span></code></td><td>Path to the shader relative to hlsl/glsl folder</td><td></td><td>For HLSL shader, <code class="shiki"><span>.hlsl</span></code> suffix is added.</td></tr><tr><td><code class="shiki"><span>fragmentShader</span></code></td><td>Path to the shader relative to hlsl/glsl folder</td><td></td><td>For HLSL shader, <code class="shiki"><span>.hlsl</span></code> suffix is added.</td></tr><tr><td><code class="shiki"><span>vertexFields</span></code></td><td>An array of fields passed to vertex shader</td><td></td><td>It&#39;s better to copy this field from vanilla material.</td></tr><tr><td><code class="shiki"><span>variants</span></code></td><td>An array of objects, which define variants of the material</td><td></td><td>It&#39;s better to copy this field from vanilla material.</td></tr><tr><td><code class="shiki"><span>+defines</span></code></td><td>An array of <code class="shiki"><span>#define</span></code> directives to add to the shader source</td><td></td><td>Useful for reusing shader, but changing some minor setting.</td></tr><tr><td><code class="shiki"><span>+states</span></code></td><td>An array of states to enable</td><td><code class="shiki"><span>[&quot;Blending&quot;, &quot;DisableAlphaWrite&quot;, &quot;DisableDepthWrite&quot;]</span></code></td><td>For OpenGL implementation, this is equivalent to <a href="https://www.khronos.org/registry/OpenGL-Refpages/gl2.1/xhtml/glEnable.xml" target="_blank" rel="noreferrer">glEnable</a> call.</td></tr><tr><td><code class="shiki"><span>-defines</span></code></td><td>An array of <code class="shiki"><span>#defines</span></code> directives to remove from inherited <code class="shiki"><span>+defines</span></code></td><td></td><td></td></tr><tr><td><code class="shiki"><span>+samplerStates</span></code></td><td>An array of objects, defining how texture at certain index is treated</td><td><code class="shiki"><span>{ &quot;samplerIndex&quot;: 0, &quot;textureFilter&quot;: &quot;Point&quot; }</span></code></td><td><code class="shiki"><span>textureFilter</span></code> specifies how to sample the texture and <code class="shiki"><span>textureWrap</span></code> specifies the behavior, when accessing outside of the texture dimensions.</td></tr><tr><td><code class="shiki"><span>msaaSupport</span></code></td><td>Multisample anti-aliasing support</td><td><code class="shiki"><span>Both</span></code></td><td></td></tr><tr><td><code class="shiki"><span>blendSrc</span></code></td><td>Specifies how the color source blending factors are computed</td><td><code class="shiki"><span>One</span></code></td><td>For OpenGL implementation, this is equivalent to <a href="https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glBlendFunc.xhtml" target="_blank" rel="noreferrer">glBlendFunc</a> call.</td></tr><tr><td><code class="shiki"><span>blendDst</span></code></td><td>Specifies how the color destination blending factors are computed</td><td><code class="shiki"><span>One</span></code></td><td>For OpenGL implementation, this is equivalent to <a href="https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glBlendFunc.xhtml" target="_blank" rel="noreferrer">glBlendFunc</a> call.</td></tr></tbody></table><p>Example:</p>',8)),i(a),s[1]||(s[1]=e(`<div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes dark-plus light-plus vp-code" tabindex="0"><code><span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">{</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">    &quot;materials&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: {</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">        &quot;version&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515;">&quot;1.0.0&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">,</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">        &quot;particle_debug&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: {</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">            &quot;vertexShader&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515;">&quot;shaders/particle_generic.vertex&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">,</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">            &quot;fragmentShader&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515;">&quot;shaders/particle_debug.fragment&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">            &quot;vertexFields&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: [{ </span><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">&quot;field&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515;">&quot;Position&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;"> }, { </span><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">&quot;field&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515;">&quot;Color&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;"> }, { </span><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">&quot;field&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515;">&quot;UV0&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;"> }],</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">            &quot;+samplerStates&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: [</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">                {</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">                    &quot;samplerIndex&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: </span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658;">0</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">,</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">                    &quot;textureFilter&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515;">&quot;Point&quot;</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">                }</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">            ],</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">            &quot;msaaSupport&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515;">&quot;Both&quot;</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">        }</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">    }</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>For all the details about material files and possible field values, check <a href="https://github.com/stirante/bedrock-shader-schema/blob/master/materials.schema.json" target="_blank" rel="noreferrer">material file JSON schema</a>.</p><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="shader-doesn-t-change" tabindex="-1">Shader doesn’t change <a class="header-anchor" href="#shader-doesn-t-change" aria-label="Permalink to &quot;Shader doesn’t change&quot;">​</a></h3><p>Every time there is a change in the shader, you need to restart Minecraft to recompile the shader completely.</p><h3 id="compilation-error" tabindex="-1">Compilation error <a class="header-anchor" href="#compilation-error" aria-label="Permalink to &quot;Compilation error&quot;">​</a></h3><p>When there is a shader compilation error, a line number is usually specified where the error occurred. You need to check a few lines above the one set in error because Minecraft adds <code class="shiki"><span>#define</span></code> directives before compilation.</p><h3 id="couldn-t-find-constant-buffer-named-globals" tabindex="-1">Couldn’t find constant buffer named: $Globals <a class="header-anchor" href="#couldn-t-find-constant-buffer-named-globals" aria-label="Permalink to &quot;Couldn’t find constant buffer named: $Globals&quot;">​</a></h3><p>I couldn’t accurately find the actual cause of this error, but it seems to be somehow connected to global variables. Removing them (initializing them in the <code class="shiki"><span>main</span></code> function or changing them to <code class="shiki"><span>#define</span></code> directives) seems to fix the problem.</p><h2 id="tips-and-tricks" tabindex="-1">Tips and tricks <a class="header-anchor" href="#tips-and-tricks" aria-label="Permalink to &quot;Tips and tricks&quot;">​</a></h2><h3 id="passing-variables-to-the-shader" tabindex="-1">Passing variables to the shader <a class="header-anchor" href="#passing-variables-to-the-shader" aria-label="Permalink to &quot;Passing variables to the shader&quot;">​</a></h3><p>You can pass variables to the shader from a particle or an entity by changing entity color. Input color is clamped to <code class="shiki"><span>&lt;0.0, 1.0&gt;</span></code>. To pass more significant values, you need to divide by max value (or at least some considerable number).</p><h3 id="using-time-in-shader" tabindex="-1">Using time in shader <a class="header-anchor" href="#using-time-in-shader" aria-label="Permalink to &quot;Using time in shader&quot;">​</a></h3><p><code class="shiki"><span>TIME</span></code> variable is a number of seconds as <code class="shiki"><span>float</span></code> and is global for all shaders. For time-based on particle lifetime, you need to pass this:</p>`,14)),i(a),s[2]||(s[2]=e(`<div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes dark-plus light-plus vp-code" tabindex="0"><code><span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">&quot;minecraft:particle_appearance_tinting&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: {</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#0451A5;">    &quot;color&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">: [</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515;">&quot;variable.particle_age/variable.particle_lifetime&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">, </span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658;">0</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">, </span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658;">0</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">, </span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658;">1</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">]</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Then in the shader, use <code class="shiki"><span>PSInput.color.r</span></code> as time, where <code class="shiki"><span>0.0</span></code> is particle birth and <code class="shiki"><span>1.0</span></code> is particle death.</p><h3 id="camera-direction-towards-the-entity" tabindex="-1">Camera direction towards the entity <a class="header-anchor" href="#camera-direction-towards-the-entity" aria-label="Permalink to &quot;Camera direction towards the entity&quot;">​</a></h3><p>For entity shaders, you can make the shader dependent on the camera direction towards the entity.</p><ul><li>Add to <code class="shiki"><span>PS_Input</span></code> in vertex and fragment shader new field</li></ul>`,5)),i(a),s[3]||(s[3]=e('<div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes dark-plus light-plus vp-code" tabindex="0"><code><span class="line"><span>float3 viewDir: POSITION;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>After that, add to vertex shader this line</li></ul>',2)),i(a),s[4]||(s[4]=e('<div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes dark-plus light-plus vp-code" tabindex="0"><code><span class="line"><span>PSInput.viewDir = normalize((mul(WORLD, mul(BONES[VSInput.boneId], float4(VSInput.position, 1)))).xyz);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>In the fragment shader, use <code class="shiki"><span>PSInput.viewDir</span></code> to make changes depending on camera rotation</li></ul><h3 id="debugging-values" tabindex="-1">Debugging values <a class="header-anchor" href="#debugging-values" aria-label="Permalink to &quot;Debugging values&quot;">​</a></h3><p>The easiest way to debug a value is to turn it into color and render it like this.</p>',4)),i(a),s[5]||(s[5]=e('<div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes dark-plus light-plus vp-code" tabindex="0"><code><span class="line"><span>PSOutput.color = float4(PSInput.uv, 0., 1.);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>This should create a red-green gradient, showing that the values of <code class="shiki"><span>uv</span></code> are between <code class="shiki"><span>&lt;0, 0&gt;</span></code> and <code class="shiki"><span>&lt;1, 1&gt;</span></code>.</p><p>You can use the debug shader I wrote <a href="http://mew.cx/drawtext/drawtext" target="_blank" rel="noreferrer">based on this shader</a>. Right now, this shader will display values of the color passed to the shader. To display another value, change line 70 in hlsl shader to</p>',3)),i(a),s[6]||(s[6]=e('<div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes dark-plus light-plus vp-code" tabindex="0"><code><span class="line"><span>int ascii = getFloatCharacter( cellIndex, &lt;float4 vector here&gt; );</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>GLSL version of debugging shader may crash Minecraft, use only for debugging.</p><p><a href="http://files.stirante.com/debugShader.zip" target="_blank" rel="noreferrer">Download debug shader</a></p><p><img src="'+o+'" alt=""></p>',4))])}const f=t(d,[["render",h]]);export{b as __pageData,f as default};
