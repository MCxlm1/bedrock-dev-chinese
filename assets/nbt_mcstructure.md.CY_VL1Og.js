import{_ as t}from"./chunks/compound._efFW2_8.js";import{_ as i,j as o,k as n,a5 as r}from"./chunks/framework.3Z9w-w8R.js";const e="/assets/images/nbt/int.png",s="/assets/images/nbt/list.png",l="/assets/images/nbt/string.png",f=JSON.parse('{"title":".mcstructure","description":"About .mcstructure format.","frontmatter":{"title":".mcstructure","category":"General","mentions":["SirLich","MedicalJewel105","Misledwater79","SmokeyStack","Robotics-Modified"],"description":"About .mcstructure format."},"headers":[{"level":2,"title":"Saving and Loading Structures","slug":"saving-and-loading-structures","link":"#saving-and-loading-structures","children":[]},{"level":2,"title":"File Format","slug":"file-format","link":"#file-format","children":[]},{"level":2,"title":"What Happens If...","slug":"what-happens-if","link":"#what-happens-if","children":[]},{"level":2,"title":"NBT File and MC Structure Comparison","slug":"nbt-file-and-mc-structure-comparison","link":"#nbt-file-and-mc-structure-comparison","children":[]},{"level":2,"title":"NBT Editors","slug":"nbt-editors","link":"#nbt-editors","children":[]}],"relativePath":"nbt/mcstructure.md","filePath":"nbt/mcstructure.md"}'),c={name:"nbt/mcstructure.md"};function d(p,a,u,h,m,g){return n(),o("div",null,a[0]||(a[0]=[r('<h2 id="saving-and-loading-structures" tabindex="-1">Saving and Loading Structures <a class="header-anchor" href="#saving-and-loading-structures" aria-label="Permalink to &quot;Saving and Loading Structures&quot;">​</a></h2><p>The <strong>Export</strong> button creates <code class="shiki"><span>.mcstructure</span></code> files in a structure block. The files must be placed in a behavior pack to load them in-game with a load structure block. The path determines the structure identifier, which is typed into the structure block to load the structure.</p><div class="warning custom-block"><p class="custom-block-title">MOBILE LIMITATION</p><p>Currently, exporting structures in Bedrock mobile is <strong>not possible</strong>. Even with an export button resource pack, the game cannot export <code class="shiki"><span>.mcstructure</span></code> files.</p></div><p><strong>Examples:</strong></p><ul><li><code class="shiki"><span>BP/structures/house.mcstructure</span></code> → <code class="shiki"><span>mystructure:house</span></code></li><li><code class="shiki"><span>BP/structures/dungeon/entrance.mcstructure</span></code> → <code class="shiki"><span>dungeon:entrance</span></code></li><li><code class="shiki"><span>BP/structures/stuff/towers/diamond.mcstructure</span></code> → <code class="shiki"><span>stuff:towers/diamond</span></code></li></ul><p>The first subfolder defines the namespace, and subsequent folders define the path, ending with the structure file&#39;s name.</p><p>Note that any files directly in the <code class="shiki"><span>structures</span></code> folder are given the <code class="shiki"><span>mystructure</span></code> namespace. If a structure exists in the <code class="shiki"><span>structures</span></code> folder and shares a name with a structure in an explicit <code class="shiki"><span>mystructure</span></code> folder, the game produces the following content log warning:</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes dark-plus light-plus vp-code" tabindex="0"><code><span class="line"><span>[structure][warning]-There was a conflict loading a structure in the default namespace. A structure with the name &lt;name&gt; was found both in the root directory and the mystructure directory.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>In this case, the file in the <code class="shiki"><span>mystructure</span></code> folder is the one that &quot;wins,&quot; resulting in the file directly in the <code class="shiki"><span>structures</span></code> folder being ignored.</p><h2 id="file-format" tabindex="-1">File Format <a class="header-anchor" href="#file-format" aria-label="Permalink to &quot;File Format&quot;">​</a></h2><blockquote><p><img src="'+e+'" alt="Integer"> <code class="shiki"><span>format_version</span></code>: Currently always set to <code class="shiki"><span>1</span></code>.</p><p><img src="'+s+'" alt="List"> <code class="shiki"><span>size</span></code>: List of three integers describing the size of the structure&#39;s bounds.</p><blockquote><p><img src="'+e+'" alt="Integer"> Size of the structure in the X direction.</p><p><img src="'+e+'" alt="Integer"> Size of the structure in the Y direction.</p><p><img src="'+e+'" alt="Integer"> Size of the structure in the Z direction.</p></blockquote><p><img src="'+t+'" alt="Compound"> <code class="shiki"><span>structure</span></code>: Actual data compound.</p><blockquote><p><img src="'+s+'" alt="List"> <code class="shiki"><span>block_indices</span></code>: List containing two sublists, one for each layer. These contain the blocks in the structure. Each block is stored as an integer index into the palette (see below). Proceeds in ZYX order from the lowest corner to the highest one. For example, if the structure size is <code class="shiki"><span>[2,3,4]</span></code>, then the 24 (product of the dimensions) values in each layer list represent the blocks located at <code class="shiki"><span>[(0,0,0), (0,0,1), (0,0,2), (0,0,3), (0,1,0), (0,1,1), (0,1,2), (0,1,3), (0,2,0), (0,2,1), (0,2,2), (0,2,3), (1,0,0), (1,0,1), (1,0,2), (1,0,3), (1,1,0), (1,1,1), (1,1,2), (1,1,3), (1,2,0), (1,2,1), (1,2,2), (1,2,3)]</span></code> relative to the origin. Index values equal to <code class="shiki"><span>-1</span></code> indicate no block, causing any existing block to remain upon loading. This occurs when structure voids are saved, and is the case for most blocks in the second layer. Both layers share the same palette.</p><blockquote><p><img src="'+s+'" alt="List"> of <img src="'+e+'" alt="Integer"> Indices for blocks in the primary layer.</p><p><img src="'+s+'" alt="List"> of <img src="'+e+'" alt="Integer"> Indices for blocks in the secondary layer. This layer is usually empty, except for water when the block here is waterlogged.</p></blockquote><p><img src="'+s+'" alt="List"> of <img src="'+t+'" alt="Compound"> <code class="shiki"><span>entities</span></code>: List of entities as NBT, stored exactly the same as entities in the world file itself. Tags like <code class="shiki"><span>Pos</span></code> and <code class="shiki"><span>UniqueID</span></code> are saved, but replaced upon loading.</p><p><img src="'+t+'" alt="Compound"> <code class="shiki"><span>palette</span></code>: Contains multiple named palettes, presumably to support multiple variants of the same structure. However, currently, only <code class="shiki"><span>default</span></code> is saved and loaded.</p><blockquote><p><img src="'+t+'" alt="Compound"> A single palette (currently only named <code class="shiki"><span>default</span></code>).</p><blockquote><p><img src="'+s+'" alt="List"> <code class="shiki"><span>block_palette</span></code>: List of block states. This list contains the ordered entries that the block indices are referring to.</p><blockquote><p><img src="'+t+'" alt="Compound"> A single block state.</p><blockquote><p><img src="'+l+'" alt="String"> <code class="shiki"><span>name</span></code>: The block&#39;s identifier, such as <code class="shiki"><span>minecraft:planks</span></code>. <img src="'+t+'" alt="Compound"> <code class="shiki"><span>states</span></code>: The block&#39;s states as keys and values. Examples: <code class="shiki"><span>wood_type:&quot;acacia&quot;</span></code>, <code class="shiki"><span>bite_counter:3</span></code>, <code class="shiki"><span>open_bit:1b</span></code>. The values are the appropriate NBT type for the state: strings for enum values, integers for scalar numbers, and bytes for boolean values. <img src="'+e+'" alt="Integer"> <code class="shiki"><span>version</span></code>: Compatibility versioning number for this block (currently <code class="shiki"><span>17959425</span></code> as of writing, in 1.19). For example, <code class="shiki"><span>17879555</span></code> is hex <code class="shiki"><span>01 10 D2 03</span></code>, meaning 1.16.210.03.</p></blockquote></blockquote><p><img src="'+t+'" alt="Compound"> <code class="shiki"><span>block_position_data</span></code>: Contains additional data for individual blocks in the structure. Each key is an integer index into the flattened list of blocks inside of <code class="shiki"><span>block_indices</span></code>. Layer is unspecified as it is irrelevant.</p><blockquote><p><img src="'+t+'" alt="Compound"> <code class="shiki"><span>&lt;index&gt;</span></code>: A single piece of additional block data, relevant to the block at its index position.</p><blockquote><p><img src="'+t+'" alt="Compound"> <code class="shiki"><span>block_entity_data</span></code>: Block entity data as NBT, stored exactly the same as block entities in the world file itself. Position tags are saved, but replaced upon loading. Layer is unspecified, as multiple block entities cannot coexist in a block space.</p><p><img src="'+s+'" alt="List"> <code class="shiki"><span>tick_queue_data</span></code>: Contains one more compounds of scheduled tick information. This is used for blocks like coral to make it die, water to make it flow, and other various scheduled updates.</p><blockquote><p><img src="'+t+'" alt="Compound"> A single pending tick.</p><blockquote><p><img src="'+e+'" alt="Integer"> <code class="shiki"><span>tick_delay</span></code>: The amount of ticks remaining until this block should be updated. No other values seem to exist adjacent to this one at this time.</p></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote><p><img src="'+s+'" alt="List"> <code class="shiki"><span>structure_world_origin</span></code>: List of three integers describing where in the world the structure was initially saved. Equal to the position of the saving structure block, plus its offset settings. This is used to determine where entities should be placed when loading. An entity&#39;s new absolute position is equal to its old position, minus these values, plus the origin of the structure&#39;s loading position.</p><blockquote><p><img src="'+e+'" alt="Integer"> Structure origin X position. <img src="'+e+'" alt="Integer"> Structure origin Y position. <img src="'+e+'" alt="Integer"> Structure origin Z position.</p></blockquote></blockquote><h2 id="what-happens-if" tabindex="-1">What Happens If... <a class="header-anchor" href="#what-happens-if" aria-label="Permalink to &quot;What Happens If...&quot;">​</a></h2><p>Results from testing to see what happens when modified structure files are loaded:</p><ul><li>If the dimensions in <code class="shiki"><span>size</span></code> exceed the vanilla save the limit of <code class="shiki"><span>64*256*64</span></code>, the structure can still be loaded just as expected.</li><li>If the values in the block layer lists are not int tags, all values are treated as <code class="shiki"><span>0</span></code>.</li><li>If a value in the block layer list is equal to or larger than the palette size or less than <code class="shiki"><span>-1</span></code>, an air block is placed.</li><li>If the <code class="shiki"><span>default</span></code> palette is not present, loading the structure results in no blocks being placed.</li><li>If any of the tags that have constant names are unspecified or are the wrong tag type, the structure fails to load with the following content log error:</li></ul><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes dark-plus light-plus vp-code" tabindex="0"><code><span class="line"><span>[Structure][error]-Loading structure &#39;&lt;identifier&gt;` from behavior pack: &#39;&lt;path&gt;&#39; | &quot;&lt;tag&gt;&quot; field, a required field, is missing from the structure.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>If <code class="shiki"><span>block_indices</span></code> does not contain exactly two values, the structure fails to load with the following content log error:</li></ul><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes dark-plus light-plus vp-code" tabindex="0"><code><span class="line"><span>[Structure][error]-Loading structure &#39;&lt;identifier&gt;` from behavior pack: &#39;&lt;path&gt;&#39; | The &quot;block_indices&quot; field should be an array with 2 arrays and instead we have &lt;count&gt; arrays.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>If the values inside of <code class="shiki"><span>block_indices</span></code> do not list tags, the structure fails to load with the following content log error:</li></ul><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes dark-plus light-plus vp-code" tabindex="0"><code><span class="line"><span>[Structure][error]-Loading structure &#39;&lt;identifier&gt;` from behavior pack: &#39;&lt;path&gt;&#39; | The &quot;block_indices&quot; field&#39;s first array is either missing or not a list.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>If the length of the two lists in <code class="shiki"><span>block_indices</span></code> are not equal, the structure fails to load with the following content log error:</li></ul><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes dark-plus light-plus vp-code" tabindex="0"><code><span class="line"><span>[Structure][error]-Loading structure &#39;&lt;identifier&gt;` from behavior pack: &#39;&lt;path&gt;&#39; | The &quot;block_indices&quot; field&#39;s arrays need to both be the same size.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>If the length of the two lists in <code class="shiki"><span>block_indices</span></code> does not equal the product of the structure&#39;s dimensions, the structure fails to load with the following content log error:</li></ul><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes dark-plus light-plus vp-code" tabindex="0"><code><span class="line"><span>[Structure][error]-Loading structure &#39;&lt;identifier&gt;` from behavior pack: &#39;&lt;path&gt;&#39; | The &quot;block_indices&quot; field should have as many elements as defined by the &quot;size&quot; field.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="nbt-file-and-mc-structure-comparison" tabindex="-1">NBT File and MC Structure Comparison <a class="header-anchor" href="#nbt-file-and-mc-structure-comparison" aria-label="Permalink to &quot;NBT File and MC Structure Comparison&quot;">​</a></h2><p><a href="https://minecraft.wiki/w/NBT_format" target="_blank" rel="noreferrer">NBT files</a>, as adapted by Java and Bedrock&#39;s .mcstructure files, couldn&#39;t be more different. But even with all these differences, they have something in common: they&#39;re stored in NBT format and use index arrays and palettes.</p><p>Here are a few main differences:</p><table tabindex="0"><thead><tr><th>MC Structure vs .NBT Structure</th><th>BE Structure File</th><th>JE Structure File</th></tr></thead><tbody><tr><td>File Format</td><td><code class="shiki"><span>.mcstructure</span></code></td><td><code class="shiki"><span>.nbt</span></code></td></tr><tr><td>Applied Compression Algorithm</td><td>None</td><td>GZip Compression</td></tr><tr><td>Endianness</td><td>Little-Endian</td><td>Big Endian</td></tr><tr><td>Root Is Property Or Value (Whether NBT starts as property)</td><td>NoName Property</td><td>NoName Property</td></tr><tr><td><code class="shiki"><span>.mcstructure</span></code> Compatible</td><td>Yes</td><td>No</td></tr><tr><td><code class="shiki"><span>.nbt</span></code> Compatible</td><td>No</td><td>Yes</td></tr><tr><td>Structure Compact Size (Lower better)</td><td>(Better) Order of blocks harcoded, only pallete indexes saved</td><td>Each block is stored as (location, palette index, optional NBT)</td></tr><tr><td>After All File Size (Lower better)</td><td>No Compression used</td><td>GZip compression outperforms the compact <code class="shiki"><span>.mcstructure</span></code> format.</td></tr></tbody></table><h2 id="nbt-editors" tabindex="-1">NBT Editors <a class="header-anchor" href="#nbt-editors" aria-label="Permalink to &quot;NBT Editors&quot;">​</a></h2><p>You can find download links for some NBT editors <a href="/meta/useful-links#software-installed">here</a>.</p><hr><p><a href="https://gist.github.com/tryashtar/87ad9654305e5df686acab05cc4b6205" target="_blank" rel="noreferrer">Original Credit</a></p>',31)]))}const v=i(c,[["render",d]]);export{f as __pageData,v as default};
